# Руководство по обучению модели для детекции курения

## Можно ли обучить свою модель?

**Да, это возможно!** Но требует подготовки данных и времени на обучение.

## Что нужно для обучения:

1. **Датасет изображений** (минимум 500-1000 изображений)
2. **Разметка данных** (аннотации - где на изображении находится сигарета/человек с сигаретой)
3. **Время на обучение** (от нескольких часов до дней, в зависимости от размера датасета)
4. **GPU** (желательно, но можно и на CPU - будет медленнее)

## Процесс обучения:

### Шаг 1: Сбор данных

Нужны изображения:
- ✅ Люди с сигаретами (разные ракурсы, освещение, позы)
- ✅ Люди без сигарет (для негативных примеров)
- ✅ Разные условия: дневной свет, ночь, разные места

**Где взять данные:**
- Собственные фото (если есть разрешение)
- Публичные датасеты (Roboflow, Kaggle)
- Синтетические данные (генерация через AI)

### Шаг 2: Разметка данных

Нужно отметить на каждом изображении:
- **Bounding box** (прямоугольник) вокруг сигареты или руки с сигаретой
- **Класс**: "smoking" или "cigarette"

**Инструменты для разметки:**
- **LabelImg** (бесплатный, простой)
- **Roboflow** (онлайн, удобный)
- **CVAT** (профессиональный)

### Шаг 3: Подготовка данных

Формат для YOLO:
```
dataset/
├── images/
│   ├── train/
│   ├── val/
│   └── test/
└── labels/
    ├── train/
    ├── val/
    └── test/
```

Каждое изображение должно иметь соответствующий `.txt` файл с аннотациями:
```
0 0.5 0.5 0.1 0.2  # класс x_center y_center width height (нормализованные координаты)
```

### Шаг 4: Обучение модели

Используем Ultralytics YOLO:

```python
from ultralytics import YOLO

# Загружаем предобученную модель
model = YOLO('yolov8n.pt')  # или yolov8s.pt, yolov8m.pt для больших моделей

# Обучаем на своих данных
results = model.train(
    data='dataset.yaml',  # конфигурационный файл
    epochs=100,           # количество эпох
    imgsz=640,           # размер изображения
    batch=16,            # размер батча
    device='cuda'        # 'cuda' для GPU, 'cpu' для CPU
)
```

### Шаг 5: Использование обученной модели

После обучения модель сохранится в `runs/detect/train/weights/best.pt`

Используем её в детекторе:
```python
detector = ViolationDetector(model_path='runs/detect/train/weights/best.pt')
```

## Альтернативные подходы:

### 1. Fine-tuning существующей модели
- Берем предобученную YOLO
- Дообучаем на своих данных
- Быстрее, чем обучение с нуля

### 2. Использование готовых моделей
- Искать готовые модели для детекции курения
- Адаптировать под свои нужды

### 3. Комбинированный подход
- YOLO для детекции людей
- Дополнительная модель для классификации действий (курение/не курение)

## Сложность:

**Средняя сложность** - требует:
- ✅ Понимания основ машинного обучения
- ✅ Умения работать с данными
- ✅ Терпения (обучение может занять время)
- ✅ Вычислительных ресурсов (GPU ускорит процесс)

## Рекомендации:

1. **Начните с малого** - соберите 100-200 изображений для теста
2. **Используйте готовые инструменты** - Roboflow, LabelImg
3. **Начните с fine-tuning** - дообучите существующую модель
4. **Используйте GPU** - если есть возможность (Google Colab бесплатно)

## Быстрый старт:

Я создам скрипт для обучения модели - `train_smoking_model.py`
Он поможет вам начать обучение с минимальными настройками.
